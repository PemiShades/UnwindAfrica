{# templates/dashboard/partials/blog_form.html #}
{# expects: blog_form, editing (bool), and when editing: post #}
{% load static widget_tweaks %}

{% if editing and post %}
  {% url 'blog_edit' slug=post.slug as action_url %}
{% else %}
  {% url 'blog_create' as action_url %}
{% endif %}

<form method="post" action="{{ action_url }}" enctype="multipart/form-data" class="grid gap-4">
  {% csrf_token %}

  <div class="grid gap-1">
    <label class="text-sm font-medium">Title</label>
    {{ blog_form.title|add_class:"field ring-brand" }}
    {{ blog_form.title.errors }}
  </div>

  <div class="grid gap-1">
    <label class="text-sm font-medium">Category</label>
    {{ blog_form.category|add_class:"field ring-brand" }}
    {{ blog_form.category.errors }}
  </div>

  <div class="grid gap-1">
    <label class="text-sm font-medium">Content</label>
    {{ blog_form.content|add_class:"field ring-brand" }}
    {{ blog_form.content.errors }}
  </div>

  <div class="grid md:grid-cols-2 gap-3">
    <div class="grid gap-1">
      <label class="text-sm font-medium">Thumbnail</label>
      {{ blog_form.thumbnail|add_class:"field ring-brand" }}
      {{ blog_form.thumbnail.errors }}
    </div>
    <div class="grid gap-1">
      <label class="text-sm font-medium">Image</label>
      {{ blog_form.image|add_class:"field ring-brand" }}
      {{ blog_form.image.errors }}
    </div>
  </div>

  <div class="flex items-center justify-end gap-2 pt-2">
    <input type="hidden" name="action" value="draft" />
    <button type="submit" class="btn-ghost">
      {% if editing %}Save Draft{% else %}Save as Draft{% endif %}
    </button>
    <button type="submit" class="btn-primary"
            onclick="this.closest('form').querySelector('[name=action]').value='publish'">
      {% if editing %}Update & Publish{% else %}Publish{% endif %}
    </button>
  </div>
</form>
